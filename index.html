<!DOCTYPE html>
<html>
  <audio id='beep' src='https://maxw.com/beep2.mp3'></audio>
  <div style='background-color:gold; width:640px;'>
    <canvas id="gameCanvas" width="640" height="480"></canvas>
  </div>
  <div style='display:none;'>
   <img id='dog' src='uk.jpg'>
    <img id='donut' src='Uk.JPG'>
    <img id='france' src='France.JPG'>
    <img id='brazil' src='Brazil.JPG'>
    <img id='china' src='China.JPG'>
    <img id='canada' src='Canada.png'>
  </div>
  <script>
    var ctx=gameCanvas.getContext("2d");
    var x=[100,300,500];
    var y=[0,0,0];
    var speed=[2,1,3];
    var targetCountryName='UK'
    var targetCountryNameLength = targetCountryName.length;
    console.log("length", targetCountryNameLength)
    var centreX = gameCanvas.width / 2;
    var rectWidth = 60;
    var rectX = centreX - rectWidth / 2;
    var targetCountryNameWidth = targetCountryNameLength;
    var targetCountryNameX = centreX - targetCountryNameWidth / 2
    var targetCountryNamePosX = targetCountryNameX
    console.log("blob", targetCountryNamePosX)
    var dogX=rectX, changeX=0, score=0;
    //var life=10
    

    var gameTimer=setInterval(mainLoop,20);
    
    function mainLoop() {
      scoreAndErasing();
      updateCoordinatesAndDrawFlags();
      rectOffScreen();
      drawTextAndRect();
    }
    
    document.onkeydown=keyPressed;
    function keyPressed(e){
      console.log('e',e)
      var k=e.keyCode;
      if(k==37){changeX=-4;}
      if(k==39){changeX=4 ;}
    }
    

    function flagRandomizer(){
      
    }
    
    function checkForHits(n){
      if((Math.abs(400-y[0] )<60)&&
      (Math.abs(dogX-x[0])<60)){
        score+=2;
        y[n]=-80; x[n]=Math.random()*600;
      }
      if((Math.abs(400-y[1] )<60)&&
        (Math.abs(dogX-x[1])<60)){
          score-=1
        y[n]=-80; x[n]=Math.random()*600;
      }
      if((Math.abs(400-y[2] )<60)&&
        (Math.abs(dogX-x[2])<60)){
          score-=1
        y[n]=-80; x[n]=Math.random()*600;
      }
    }
    function scoreAndErasing(){
      ctx.clearRect(0, 0, 640, 480);
      ctx.font = '30px Arial'
      ctx.fillStyle = "black";
      ctx.fillText("Score: " + score, 10, 30);
    }
    function updateCoordinatesAndDrawFlags(){
      for (var n=0; n<3; n++){
        if (n==0){
          ctx.drawImage(donut,x[0],y[0],100,80);
        } else if (n==1){
          ctx.drawImage(france,x[1],y[1],100,80);
        } else {
          ctx.drawImage(canada,x[2],y[2],100,80);
        }
        y[n]=y[n]+speed[n];
        checkForHits(n);
        //checkForHits1(n);
        //checkForHits2(n);
        if(y[n]>480){
          y[n]=-80; x[n]=Math.random()*600;
        }
      }
    }
    function rectOffScreen(){
      if (dogX > 640) {
  dogX = -80;
}
if (dogX < -80) {
  dogX = 640
}
    }
    function drawTextAndRect(){
              ctx.fillStyle = "blue";
        ctx.fillRect(dogX, 380, 60, 40);
        //ctx.fillStyle = "black";
        //ctx.font="30ps Arial";
        //ctx.fillText("UK", dogX, 400);

        ctx.font = '10px Arial'
        ctx.strokeStyle = 'white';
        ctx.lineWidth = 3;
        ctx.strokeText('UK', targetCountryNamePosX, 440);
        ctx.fillStyle = 'black';
        ctx.fillText("UK", targetCountryNamePosX, 440);

        dogX += changeX;
    }
    
    setTimeout(gameOver,60000);
    
    function gameOver(){
      clearInterval(gameTimer);
      ctx.font="80ps Arial";
      ctx.fillText("Game Over!",100,250);
    }
  </script>
</html>